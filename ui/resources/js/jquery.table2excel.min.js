!function(e,t,n,l){function a(t,n,l){this.element=t,this.settings=e.extend({},m,n,l),this._defaults=m,this._name=r,this.init(),l()}function s(e){return e.filename?e.filename:"table2excel"}function i(e){var t=/(\s+alt\s*=\s*"([^"]*)"|\s+alt\s*=\s*'([^']*)')/i;return e.replace(/<img[^>]*>/gi,function(e){var n=t.exec(e);return null!==n&&n.length>=2?n[2]:""})}function o(e){return e.replace(/<a[^>]*>|<\/a>/gi,"")}function c(e){var t=/(\s+value\s*=\s*"([^"]*)"|\s+value\s*=\s*'([^']*)')/i;return e.replace(/<input[^>]*>|<\/input>/gi,function(e){var n=t.exec(e);return null!==n&&n.length>=2?n[2]:""})}var r="table2excel",m={exclude:".noExl",name:"Table2Excel",filename:"table2excel",fileext:".xls",exclude_img:!0,exclude_links:!0,exclude_inputs:!0};a.prototype={init:function(){var t=this,n='<meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">';t.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">'+n+"<head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>",sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},t.tableRows=[],e(t.element).each(function(n,l){var a="";e(l).find("tr").not(t.settings.exclude).each(function(n,l){a+="<tr>",e(l).find("td,th").not(t.settings.exclude).each(function(n,l){var s={rows:e(this).attr("rowspan"),cols:e(this).attr("colspan"),style:e(this).attr("style"),flag:e(l).find(t.settings.exclude)};s.flag.length>0?a+="<td> </td>":s.rows&s.cols?a+="<td style='"+s.style+"' >"+e(l).html()+"</td>":(a+="<td style='"+s.style+"' ",s.rows>0&&(a+=" rowspan='"+s.rows+"' "),s.cols>0&&(a+=" colspan='"+s.cols+"' "),a+="/>"+e(l).html()+"</td>")}),a+="</tr>"}),t.settings.exclude_img&&(a=i(a)),t.settings.exclude_links&&(a=o(a)),t.settings.exclude_inputs&&(a=c(a)),t.tableRows.push(a)}),t.tableToExcel(t.tableRows,t.settings.name,t.settings.sheetName)},tableToExcel:function(l,a,i){var o,c,r,m=this,u="";if(m.format=function(e,t){return e.replace(/{(\w+)}/g,function(e,n){return t[n]})},i="undefined"==typeof i?"Sheet":i,m.ctx={worksheet:a||"Worksheet",table:l,sheetName:i},u=m.template.head,e.isArray(l))for(o in l)u+=m.template.sheet.head+i+o+m.template.sheet.tail;if(u+=m.template.mid,e.isArray(l))for(o in l)u+=m.template.table.head+"{table"+o+"}"+m.template.table.tail;u+=m.template.foot;for(o in l)m.ctx["table"+o]=l[o];delete m.ctx.table;var x=!!n.documentMode;if(x)if("undefined"!=typeof Blob){u=m.format(u,m.ctx),u=[u];var d=new Blob(u,{type:"text/html"});t.navigator.msSaveBlob(d,s(m.settings))}else txtArea1.document.open("text/html","replace"),txtArea1.document.write(m.format(u,m.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,s(m.settings));else{var h=new Blob([m.format(u,m.ctx)],{type:"application/vnd.ms-excel"});t.URL=t.URL||t.webkitURL,c=t.URL.createObjectURL(h),r=n.createElement("a"),r.download=s(m.settings),r.href=c,n.body.appendChild(r),r.click(),n.body.removeChild(r)}return!0}},e.fn[r]=function(t,n){var l=this;return l.each(function(){e.data(l,"plugin_"+r)||e.data(l,"plugin_"+r,new a(this,t,n))}),l}}(jQuery,window,document);