!function(e){"use strict";var t;"object"==typeof exports?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):(t=window.tabOverride={},e(t))}(function(e){"use strict";function t(e,t){var n,r,i,l=["alt","ctrl","meta","shift"],o=e.length,s=!0;for(n=0;o>n;n+=1)if(!t[e[n]]){s=!1;break}if(s)for(n=0;n<l.length;n+=1){if(i=l[n]+"Key",t[i])if(o){for(s=!1,r=0;o>r;r+=1)if(i===e[r]){s=!0;break}}else s=!1;if(!s)break}return s}function n(e,n){return e===p&&t(y,n)}function r(e,n){return e===m&&t(E,n)}function i(e,t){return function(n,r){var i,l="";if(arguments.length){if("number"==typeof n&&(e(n),t.length=0,r&&r.length))for(i=0;i<r.length;i+=1)t.push(r[i]+"Key");return this}for(i=0;i<t.length;i+=1)l+=t[i].slice(0,-3)+"+";return l+e()}}function l(e){e=e||event;var t,i,l,o,s,a,c,u,f,y,E,L,S,k,w,T,O,K,A=e.currentTarget||e.srcElement,C=e.keyCode,D="character";if((!A.nodeName||"textarea"===A.nodeName.toLowerCase())&&(C===p||C===m||13===C&&x)){if(b=!1,l=A.value,u=A.scrollTop,"number"==typeof A.selectionStart)f=A.selectionStart,y=A.selectionEnd,E=l.slice(f,y);else{if(!v.selection)return;o=v.selection.createRange(),E=o.text,s=o.duplicate(),s.moveToElementText(A),s.setEndPoint("EndToEnd",o),y=s.text.length,f=y-E.length,h>1?(a=l.slice(0,f).split(d).length-1,c=E.split(d).length-1):a=c=0}if(C===p||C===m)if(t=g,i=t.length,k=0,w=0,T=0,f!==y&&-1!==E.indexOf("\n"))if(L=0===f||"\n"===l.charAt(f-1)?f:l.lastIndexOf("\n",f-1)+1,y===l.length||"\n"===l.charAt(y)?S=y:"\n"===l.charAt(y-1)?S=y-1:(S=l.indexOf("\n",y),-1===S&&(S=l.length)),n(C,e))k=1,A.value=l.slice(0,L)+t+l.slice(L,S).replace(/\n/g,function(){return k+=1,"\n"+t})+l.slice(S),o?(o.collapse(),o.moveEnd(D,y+k*i-c-a),o.moveStart(D,f+i-a),o.select()):(A.selectionStart=f+i,A.selectionEnd=y+k*i,A.scrollTop=u);else{if(!r(C,e))return;0===l.slice(L).indexOf(t)&&(L===f?E=E.slice(i):T=i,w=i),A.value=l.slice(0,L)+l.slice(L+T,f)+E.replace(new RegExp("\n"+t,"g"),function(){return k+=1,"\n"})+l.slice(y),o?(o.collapse(),o.moveEnd(D,y-w-k*i-c-a),o.moveStart(D,f-T-a),o.select()):(A.selectionStart=f-T,A.selectionEnd=y-w-k*i)}else if(n(C,e))o?(o.text=t,o.select()):(A.value=l.slice(0,f)+t+l.slice(y),A.selectionEnd=A.selectionStart=f+i,A.scrollTop=u);else{if(!r(C,e))return;0===l.slice(f-i).indexOf(t)&&(A.value=l.slice(0,f-i)+l.slice(f),o?(o.move(D,f-i-a),o.select()):(A.selectionEnd=A.selectionStart=f-i,A.scrollTop=u))}else if(x){if(0===f||"\n"===l.charAt(f-1))return void(b=!0);if(L=l.lastIndexOf("\n",f-1)+1,S=l.indexOf("\n",f),-1===S&&(S=l.length),O=l.slice(L,S).match(/^[ \t]*/)[0],K=O.length,L+K>f)return void(b=!0);o?(o.text="\n"+O,o.select()):(A.value=l.slice(0,f)+"\n"+O+l.slice(y),A.selectionEnd=A.selectionStart=f+h+K,A.scrollTop=u)}return e.preventDefault?void e.preventDefault():(e.returnValue=!1,!1)}}function o(e){e=e||event;var t=e.keyCode;if(n(t,e)||r(t,e)||13===t&&x&&!b){if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}function s(e,t){var n,r=S[e]||[],i=r.length;for(n=0;i>n;n+=1)r[n].apply(null,t)}function a(e){function t(t){for(n=0;l>n;n+=1)t(e[n].type,e[n].handler)}var n,r,i,l=e.length;return v.addEventListener?(r=function(e){t(function(t,n){e.removeEventListener(t,n,!1)})},i=function(e){r(e),t(function(t,n){e.addEventListener(t,n,!1)})}):v.attachEvent&&(r=function(e){t(function(t,n){e.detachEvent("on"+t,n)})},i=function(e){r(e),t(function(t,n){e.attachEvent("on"+t,n)})}),{add:i,remove:r}}function c(e){s("addListeners",[e]),f.add(e)}function u(e){s("removeListeners",[e]),f.remove(e)}var f,d,h,v=window.document,g="	",p=9,m=9,y=[],E=["shiftKey"],x=!0,b=!1,L=v.createElement("textarea"),S={};f=a([{type:"keydown",handler:l},{type:"keypress",handler:o}]),L.value="\n",d=L.value,h=d.length,L=null,e.utils={executeExtensions:s,isValidModifierKeyCombo:t,createListeners:a,addListeners:c,removeListeners:u},e.handlers={keydown:l,keypress:o},e.addExtension=function(e,t){return e&&"string"==typeof e&&"function"==typeof t&&(S[e]||(S[e]=[]),S[e].push(t)),this},e.set=function(e,t){var n,r,i,l,o,a,f;if(e)for(n=arguments.length<2||t,r=e,i=r.length,"number"!=typeof i&&(r=[r],i=1),n?(l=c,o="true"):(l=u,o=""),a=0;i>a;a+=1)f=r[a],f&&f.nodeName&&"textarea"===f.nodeName.toLowerCase()&&(s("set",[f,n]),f.setAttribute("data-taboverride-enabled",o),l(f));return this},e.tabSize=function(e){var t;if(arguments.length){if(e&&"number"==typeof e&&e>0)for(g="",t=0;e>t;t+=1)g+=" ";else g="	";return this}return"	"===g?0:g.length},e.autoIndent=function(e){return arguments.length?(x=e?!0:!1,this):x},e.tabKey=i(function(e){return arguments.length?void(p=e):p},y),e.untabKey=i(function(e){return arguments.length?void(m=e):m},E)});